---
// src/components/ThemeToggle.astro
---

<!-- Inline script untuk prevent flash - HARUS di atas HTML -->
<script is:inline>
  (function() {
    const theme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (theme === 'dark' || (!theme && prefersDark)) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  })();
</script>

<button
  id="theme-toggle"
  class="w-10 h-10 rounded-full flex items-center justify-center
         bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200
         hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors
         focus:outline-none focus:ring-2 focus:ring-blue-500"
  aria-label="Toggle Theme"
>
  <span class="sun-icon text-xl">‚òÄÔ∏è</span>
  <span class="moon-icon text-xl hidden">üåô</span>
</button>

<script>
  function updateIcons() {
    const isDark = document.documentElement.classList.contains('dark');
    const sunIcon = document.querySelector('.sun-icon');
    const moonIcon = document.querySelector('.moon-icon');
    
    if (isDark) {
      sunIcon?.classList.add('hidden');
      moonIcon?.classList.remove('hidden');
    } else {
      sunIcon?.classList.remove('hidden');
      moonIcon?.classList.add('hidden');
    }
  }

  function toggleTheme() {
    const html = document.documentElement;
    const isDark = html.classList.contains('dark');
    
    if (isDark) {
      html.classList.remove('dark');
      localStorage.setItem('theme', 'light');
    } else {
      html.classList.add('dark');
      localStorage.setItem('theme', 'dark');
    }
    
    updateIcons();
  }

  // Set icon on page load
  document.addEventListener('DOMContentLoaded', () => {
    updateIcons();
    
    const toggleBtn = document.getElementById('theme-toggle');
    toggleBtn?.addEventListener('click', toggleTheme);
  });
</script>
